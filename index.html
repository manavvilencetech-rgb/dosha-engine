<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dosha Oscillation Engine</title>

<!-- CSS -->
<style>
body {
    margin: 0;
    padding: 0;
    background: #0b0b0b;
    font-family: "Poppins", sans-serif;
    color: #fff;
}

/* Navbar */
.navbar {
    width: 100%;
    background: rgba(15,15,15,0.85);
    backdrop-filter: blur(10px);
    padding: 14px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid rgba(255,215,0,0.25);
}
.logo { font-size: 20px; font-weight:600; color: gold; letter-spacing:0.5px;}
.nav-links { list-style:none; display:flex; gap:25px; }
.nav-links a { text-decoration:none; color:#e6e6e6; font-size:16px; padding:8px 14px; border-radius:8px; transition:0.3s ease;}
.nav-links a:hover { color:#000; background:gold; box-shadow:0 0 8px gold; }

/* Hero */
.hero-section { text-align:center; margin-top:80px; animation:fadeInUp 1.2s ease;}
.hero-logo { width:110px; height:110px; border-radius:50%; margin-bottom:20px; filter:drop-shadow(0 0 10px rgba(255,215,0,0.4)); animation:breathe 4s infinite ease-in-out;}
.hero-title { font-size:32px; font-weight:700; color:gold; letter-spacing:1px;}
.hero-tagline { font-size:17px; font-weight:300; color:#d8d8d8; margin-top:8px; }

@keyframes fadeInUp { 0% { opacity:0; transform:translateY(30px);} 100% { opacity:1; transform:translateY(0);} }
@keyframes breathe { 0%,100% { transform: scale(1);} 50% { transform: scale(1.06);} }

/* Dosha container */
.dosha-container { display:flex; flex-direction:column; align-items:center; margin-top:60px; position:relative; }
canvas { border-radius:50%; background: radial-gradient(circle, #0f0f0f, #000); box-shadow: 0 0 25px rgba(255,215,0,0.3), 0 0 50px rgba(255,215,0,0.15); position:relative; z-index:2; }
.dosha-values { margin-top:25px; text-align:center; font-size:20px; color:gold; letter-spacing:1px; }

/* Glow & pulse */
.aura-glow, .glow-ring { position:absolute; width:360px; height:360px; border-radius:50%; background: radial-gradient(circle, rgba(255,215,0,0.35), rgba(0,0,0,0) 70%); filter:blur(35px); pointer-events:none; z-index:0;}
.pulse-glow { animation:pulseGlow 4s ease-in-out infinite; transition: all 0.3s ease-in-out; }
@keyframes pulseGlow {
    0% { transform: scale(1); filter:blur(25px) brightness(1); opacity:0.85; }
    50% { transform: scale(1.03); filter:blur(30px) brightness(1.18); opacity:1; }
    100% { transform: scale(1); filter:blur(25px) brightness(1); opacity:0.85; }
}

/* Wave rings */
.wave-ring {
    position:absolute; width:260px; height:260px; border-radius:50%; border:2px solid rgba(255,215,0,0.28);
    left:50%; top:50%; transform:translate(-50%, -50%);
    animation: waveRing 4s ease-out infinite; pointer-events:none;
}
.wave-ring:nth-child(2){ animation-delay:1.2s;}
.wave-ring:nth-child(3){ animation-delay:2.4s;}
@keyframes waveRing{
    0% { transform:translate(-50%, -50%) scale(0.75); opacity:0.5;}
    70% { opacity:0.15;}
    100% { transform:translate(-50%, -50%) scale(2.2); opacity:0;}
}

/* Factor panel */
.factor-panel {
    width:90%; max-width:600px; margin:60px auto; background:rgba(20,20,20,0.35); padding:25px; border-radius:20px; color:gold;
    border:1px solid rgba(255,215,0,0.3); backdrop-filter:blur(8px);
}
.factor-panel h2 { text-align:center; margin-bottom:20px;}
.factor-panel label { display:block; margin-top:18px; margin-bottom:5px; font-size:16px;}
.factor-panel input[type="range"] { width:100%; }
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
const { jsPDF } = window.jspdf;

// JSON Export
document.getElementById("downloadJSON").onclick = function () {
    let data = {
        timestamp: new Date().toISOString(),
        vata: Math.round(vata),
        pitta: Math.round(pitta),
        kapha: Math.round(kapha),
        factors: {
            sleep: getFactor("sleep"),
            hydration: getFactor("hydration"),
            stress: getFactor("stress"),
            agni: getFactor("agni"),
            temperature: getFactor("temp"),
            food: getFactor("food"),
            routine: getFactor("routine"),
            season: getFactor("season"),
            ama: getFactor("ama"),
            activity: getFactor("activity")
        }
    };
    const file = new Blob([JSON.stringify(data, null, 2)], {type: "application/json"});
    const link = document.createElement("a");
    link.href = URL.createObjectURL(file);
    link.download = "dosha_snapshot.json";
    link.click();
};

// PDF Export
document.getElementById("downloadPDF").onclick = function () {
    const doc = new jsPDF();

    doc.setFontSize(14);
    doc.setTextColor(255, 215, 0); // gold header
    doc.text("ðŸ§˜ Dosha Oscillation Report", 10, 15);

    doc.setFontSize(12);
    doc.setTextColor(255, 255, 255);

    doc.text(`Generated: ${new Date().toLocaleString()}`, 10, 25);
    doc.text(`Vata: ${Math.round(vata)}`, 10, 35);
    doc.text(`Pitta: ${Math.round(pitta)}`, 10, 45);
    doc.text(`Kapha: ${Math.round(kapha)}`, 10, 55);

    doc.text("-----------------------------", 10, 65);
    doc.text("Input Factors:", 10, 75);

    const factors = ["sleep","hydration","stress","agni","temp","food","routine","season","ama","activity"];
    let y = 85;
    factors.forEach(f => {
        doc.text(`${f.charAt(0).toUpperCase()+f.slice(1)}: ${getFactor(f)}`, 10, y);
        y += 8;
    });

    doc.save("Dosha_Report.pdf");
};

// PNG Screenshot Export
document.getElementById("downloadPNG").onclick = function() {
    html2canvas(document.body).then(canvas => {
        const link = document.createElement("a");
        link.download = "dosha_screenshot.png";
        link.href = canvas.toDataURL();
        link.click();
    });
};
</script>
    
</head>
<body>

<!-- Navigation -->
<nav class="navbar">
    <div class="logo">Dosha Oscillation Engine</div>
    <ul class="nav-links">
        <li><a href="#home">Home</a></li>
        <li><a href="#oscillation">Oscillation</a></li>
        <li><a href="#prakriti">Prakriti</a></li>
        <li><a href="#settings">Settings</a></li>
    </ul>
</nav>

<!-- Hero -->
<header class="hero-section">
    <img src="logo.png" alt="Logo" class="hero-logo"/>
    <h1 class="hero-title">Dosha Oscillation Engine</h1>
    <p class="hero-tagline">Luxury Healing Through Ayurvedic Intelligence...</p>
</header>

<!-- Dosha container -->
<div class="dosha-container">
    <div class="glow-ring pulse-glow"></div>
    <div class="wave-ring"></div>
    <div class="wave-ring"></div>
    <div class="wave-ring"></div>
    <div class="aura-glow pulse-glow"></div>
    <canvas id="doshaCanvas" width="380" height="380"></canvas>

    <div class="dosha-values">
        <p>Vata: <span id="vataVal">40</span></p>
        <p>Pitta: <span id="pittaVal">35</span></p>
        <p>Kapha: <span id="kaphaVal">25</span></p>
    </div>
</div>

<!-- Factor panel -->
<div class="factor-panel">
    <h2>Dosha Factor Inputs</h2>
    <label>Sleep Quality</label><input type="range" min="0" max="100" value="70" id="sleep">
    <label>Hydration Level</label><input type="range" min="0" max="100" value="60" id="hydration">
    <label>Stress Level</label><input type="range" min="0" max="100" value="40" id="stress">
    <label>Agni (Digestion Strength)</label><input type="range" min="0" max="100" value="55" id="agni">
    <label>Temperature (Hot/Cold)</label><input type="range" min="0" max="100" value="45" id="temp">
    <label>Food Type (Ushna, Snigdha, Rukshaâ€¦)</label><input type="range" min="0" max="100" value="50" id="food">
    <label>Daily Routine Stability</label><input type="range" min="0" max="100" value="65" id="routine">
    <label>Seasonal Effect</label><input type="range" min="0" max="100" value="50" id="season">
    <label>Ama (Toxin Load)</label><input type="range" min="0" max="100" value="30" id="ama">
    <label>Activity Level</label><input type="range" min="0" max="100" value="75" id="activity">
</div>

<!-- Export buttons -->
<div style="margin-top:20px; text-align:center;">
    <button id="downloadPDF" style="padding:8px 18px; border-radius:6px; background:#ffd700; color:#000; border:none;">ðŸ“„ Download PDF Report</button>
    <button id="downloadJSON" style="padding:8px 18px; border-radius:6px; background:#ffaa00; color:#000; border:none; margin-left:10px;">ðŸ§¾ Export JSON</button>
    <button id="downloadPNG" style="padding:8px 18px; border-radius:6px; background:#55ffcc; color:#000; border:none; margin-left:10px;">ðŸ“¸ Save Screenshot</button>
</div>

<!-- Sound toggle -->
<div id="soundToggle" style="cursor:pointer; margin-top:10px; color:#ffd700; font-size:14px; opacity:0.7; text-align:center;">ðŸ”ˆ Sound: OFF</div>

<!-- JS -->
<script>
// -----------------------------
// STEP B9 â€” Dosha Oscillation Engine
// -----------------------------
let canvas = document.getElementById("doshaCanvas");
let ctx = canvas.getContext("2d");

let vata = 40, pitta = 35, kapha = 25;
let t = 0;

// Slider helper
function getFactor(id) { return parseInt(document.getElementById(id).value); }

// Draw colored dosha rings
function drawRings() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const centerX = canvas.width/2, centerY = canvas.height/2;
    const baseRadius = 80;

    ctx.lineWidth = 6;

    // Vata
    ctx.beginPath();
    ctx.arc(centerX, centerY, baseRadius + vata, 0, Math.PI*2);
    ctx.strokeStyle = "rgba(173,216,230,0.8)";
    ctx.stroke();

    // Pitta
    ctx.beginPath();
    ctx.arc(centerX, centerY, baseRadius + pitta, 0, Math.PI*2);
    ctx.strokeStyle = "rgba(255,140,0,0.8)";
    ctx.stroke();

    // Kapha
    ctx.beginPath();
    ctx.arc(centerX, centerY, baseRadius + kapha, 0, Math.PI*2);
    ctx.strokeStyle = "rgba(144,238,144,0.8)";
    ctx.stroke();

    // Update values
    document.getElementById("vataVal").innerText = Math.round(vata);
    document.getElementById("pittaVal").innerText = Math.round(pitta);
    document.getElementById("kaphaVal").innerText = Math.round(kapha);
}

// -----------------------------
// STEP B12 â€” Audio Engine
// -----------------------------
<script>
let audioEnabled = false;
let audioCtx = null;

function initAudio() {
    if (audioCtx) return;

    audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    // Deep Prana Hum
    const droneOsc = audioCtx.createOscillator();
    droneOsc.type = "sine";
    droneOsc.frequency.value = 80;
    const droneGain = audioCtx.createGain();
    droneGain.gain.value = 0.0;
    droneOsc.connect(droneGain).connect(audioCtx.destination);
    droneOsc.start();

    // Light Vata Pulse
    const vataOsc = audioCtx.createOscillator();
    vataOsc.type = "sine";
    vataOsc.frequency.value = 200;
    const vataGain = audioCtx.createGain();
    vataGain.gain.value = 0.0;
    vataOsc.connect(vataGain).connect(audioCtx.destination);
    vataOsc.start();

    window.doshaAudio = { droneOsc, droneGain, vataOsc, vataGain };
}

// Toggle button
document.getElementById("soundToggle").onclick = function () {
    if (!audioCtx) initAudio();
    audioEnabled = !audioEnabled;

    this.innerText = audioEnabled ? "ðŸ”Š Sound: ON" : "ðŸ”ˆ Sound: OFF";

    if (audioEnabled) {
        window.doshaAudio.droneGain.gain.setTargetAtTime(0.25, audioCtx.currentTime, 0.1);
        window.doshaAudio.vataGain.gain.setTargetAtTime(0.12, audioCtx.currentTime, 0.1);
    } else {
        window.doshaAudio.droneGain.gain.setTargetAtTime(0, audioCtx.currentTime, 0.1);
        window.doshaAudio.vataGain.gain.setTargetAtTime(0, audioCtx.currentTime, 0.1);
    }
};

    
// -----------------------------
// STEP B9 â€” Animate doshas
// -----------------------------
function animateDosha(){
    t += 0.02;
    // Read factors
    let sleep=getFactor("sleep"), hydration=getFactor("hydration"), stress=getFactor("stress"),
        agni=getFactor("agni"), temp=getFactor("temp"), food=getFactor("food"),
        routine=getFactor("routine"), season=getFactor("season"),
        ama=getFactor("ama"), activity=getFactor("activity");

    // Oscillation
    vata += Math.sin(t*2.5)*0.3*(stress/10+season/20+activity/15);
    pitta += Math.cos(t*1.8)*0.3*(temp/15+food/25+stress/10);
    kapha += Math.sin(t*1.2 + Math.cos(t*2))*0.3*(hydration/10 + ama/15 + routine/18);

    // Normalize
    let total=vata+pitta+kapha;
    vata=(vata/total)*100; pitta=(pitta/total)*100; kapha=(kapha/total)*100;

    // Audio follow
    if(audioEnabled && window.doshaAudio){
        window.doshaAudio.droneOsc.frequency.value = 60 + kapha*0.4;
        window.doshaAudio.vataOsc.frequency.value = 140 + vata*0.8;
    }

    drawRings();
    requestAnimationFrame(animateDosha);
}
animateDosha();

// -----------------------------
// STEP B14 â€” Ayurvedic Intelligence Engine
// -----------------------------
function analyzeDoshaState(v,p,k){
    const highest = Math.max(v,p,k);
    let type="";
    if(highest===v) type="Vata-dominant state";
    if(highest===p) type="Pitta-dominant state";
    if(highest===k) type="Kapha-dominant state";
    let spread = Math.abs(v-p)+Math.abs(p-k)+Math.abs(k-v);
    let intensity = spread<30?"Balanced":(spread<60?"Moderate Oscillation":"High Instability (Chaotic)");
    return {type,intensity};
}

function factorInterpretation(){
    const f=id=>getFactor(id);
    let notes=[];
    if(f("stress")>70) notes.push("High stress is sharply increasing Vata instability.");
    if(f("sleep")<30) notes.push("Low sleep is aggravating Vata and reducing grounding.");
    if(f("hydration")<40) notes.push("Low hydration is weakening Pitta-Kapha stability.");
    if(f("ama")>60) notes.push("High Ama is disturbing Kapha and blocking Agni.");
    if(f("agni")<40) notes.push("Weak Agni is slowing digestion and elevating Kapha dampness.");
    if(f("temp")>70) notes.push("High temperature is overheating and sharpening Pitta.");
    if(f("food")>70) notes.push("Heavy food load is pushing Kapha upward.");
    if(f("activity")<30) notes.push("Low activity is reducing Vata flow and increasing Kapha stagnation.");
    if(f("season")>70) notes.push("Seasonal influence is amplifying dosha oscillation.");
    return notes;
}

function generateAyurvedicInsight(){
    const state=analyzeDoshaState(vata,pitta,kapha);
    const factors=factorInterpretation();
    let msg=`ðŸ§  Ayurvedic Analysis
Dosha State: ${state.type}
Oscillation: ${state.intensity}\n`;
    if(factors.length>0){
        msg+="Key Influences:\n";
        factors.forEach(n=>{ msg+="â€¢ "+n+"\n"; });
    } else { msg+="All factors appear within stable ranges."; }
    return msg;
}

const reasoningBox=document.createElement("div");
reasoningBox.id="ayurvedaAI";
reasoningBox.style.marginTop="20px";
reasoningBox.style.padding="15px";
reasoningBox.style.borderRadius="10px";
reasoningBox.style.background="rgba(255,255,255,0.05)";
reasoningBox.style.color="#fff";
reasoningBox.style.fontSize="14px";
reasoningBox.style.lineHeight="1.5";
reasoningBox.style.whiteSpace="pre-line";
document.body.appendChild(reasoningBox);

setInterval(()=>{ reasoningBox.innerText=generateAyurvedicInsight(); }, 2000);

// -----------------------------
// STEP B13 â€” Export (PDF/JSON/PNG)
// -----------------------------
document.getElementById("downloadJSON").onclick=function(){
    const data={timestamp:new Date().toISOString(),vata:Math.round(vata),pitta:Math.round(pitta),kapha:Math.round(kapha),
    factors:{sleep:getFactor("sleep"),hydration:getFactor("hydration"),stress:getFactor("stress"),agni:getFactor("agni"),
    temperature:getFactor("temp"),food:getFactor("food"),routine:getFactor("routine"),season:getFactor("season"),
    ama:getFactor("ama"),activity:getFactor("activity")}};
    const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
    const link=document.createElement("a"); link.href=URL.createObjectURL(blob); link.download="dosha_snapshot.json"; link.click();
};

document.getElementById("downloadPDF").onclick=function(){
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    doc.setFontSize(12);
    doc.text("Dosha Oscillation Report", 10, 10);
    doc.text(`Generated: ${new Date().toLocaleString()}`, 10, 20);
    doc.text(`Vata: ${Math.round(vata)}`, 10, 30);
    doc.text(`Pitta: ${Math.round(pitta)}`, 10, 40);
    doc.text(`Kapha: ${Math.round(kapha)}`, 10, 50);
    doc.text("-----------------------------", 10, 60);
    doc.text("Input Factors:", 10, 70);
    let y = 80;
    const factorList = ["sleep","hydration","stress","agni","temp","food","routine","season","ama","activity"];
    factorList.forEach(f => {
        doc.text(`${f.charAt(0).toUpperCase()+f.slice(1)}: ${getFactor(f)}`, 10, y);
        y += 10;
    });
    doc.save("Dosha_Report.pdf");
};

document.getElementById("downloadPNG").onclick = function() {
    html2canvas(document.body).then(canvas => {
        const link = document.createElement("a");
        link.download = "dosha_screenshot.png";
        link.href = canvas.toDataURL();
        link.click();
    });
};
</script>

</body>
</html>
